/*
 * Copyright (C) 2023 Synopsys Inc.
 * http://www.synopsys.com/
 * All rights reserved.
 *
 * This software is the confidential and proprietary information of
 * Synopsys ("Confidential Information"). You shall not
 * disclose such Confidential Information and shall use it only in
 * accordance with the terms of the license agreement you entered into
 * with Synopsys.
 */
package com.synopsys.kb.httpclient.model;

import java.time.OffsetDateTime;
import java.util.List;
import java.util.Optional;

import javax.annotation.Nullable;

import com.google.common.collect.ImmutableList;

/**
 * Sourced vulnerability.
 * 
 * Common vulnerability properties across all sourced vulnerabilities.
 * 
 * Package protected.
 * 
 * @author skatzman
 */
public abstract class SourcedVulnerability extends AbstractEntity {
    private final String description;

    private final OffsetDateTime publishedDate;

    private final OffsetDateTime lastModifiedDate;

    @Nullable
    private final Cvss2Score cvss2Score;

    @Nullable
    private final Cvss3Score cvss3Score;

    private final List<VulnerabilityReference> references;

    @Nullable
    private final VulnerabilityStatus status;

    private final Meta meta;

    protected SourcedVulnerability(String description,
            OffsetDateTime publishedDate,
            OffsetDateTime lastModifiedDate,
            Cvss2Score cvss2Score,
            Cvss3Score cvss3Score,
            List<VulnerabilityReference> references,
            VulnerabilityStatus status,
            Meta meta) {
        super();

        this.description = description;
        this.publishedDate = publishedDate;
        this.lastModifiedDate = lastModifiedDate;
        this.cvss2Score = cvss2Score;
        this.cvss3Score = cvss3Score;
        this.references = (references != null) ? ImmutableList.copyOf(references) : ImmutableList.of();
        this.status = status;
        this.meta = meta;
    }

    /**
     * Gets the id of this vulnerability.
     * 
     * @return Returns the id of this vulnerability.
     */
    public abstract String getId();

    public String getDescription() {
        return description;
    }

    public OffsetDateTime getPublishedDate() {
        return publishedDate;
    }

    public OffsetDateTime getLastModifiedDate() {
        return lastModifiedDate;
    }

    public Optional<Cvss2Score> getCvss2Score() {
        return Optional.ofNullable(cvss2Score);
    }

    public Optional<Cvss3Score> getCvss3Score() {
        return Optional.ofNullable(cvss3Score);
    }

    public List<VulnerabilityReference> getReferences() {
        return references;
    }

    public Optional<VulnerabilityStatus> getStatus() {
        return Optional.ofNullable(status);
    }

    public Meta getMeta() {
        return meta;
    }
}
